<template name="pos_printInvoice">

    {{#if data}}
        {{#with data}}
            <div align="center" class="container"
                 style="font-family: 'Khmer OS Battambang'; font-size: 12px; width:595px; margin: 0 auto;">
                <span><button class="hidden-print btn btn-small btn-primary printInvoice"><i class="fa fa-print"></i> Print</button></span>
                <span><a href="/cement/invoice" class="hidden-print btn btn-small btn-default">Back</a></span>
                <div class="invoice-title">

                    <br>
                    <span style="font-weight: bold;font-size: 16px;​font-family:'Khmer OS Muol Light'">
                            វិក្កយបត្រ</span><br>
                    <span style="font-weight: bold;font-size: 18px;">
                            Invoice
                            </span>
                    <div class="col-md-12">
                        <table width="100%">

                            <!--

                    <tr>
                        <td>#{{sale._id}}</td>
                        <td align="right">Staff: {{sale._staff.username}}</td>
                    </tr>
                    <tr>
                        <td>Date:{{numFormat sale.saleDate 'DD/MM/YYYY HH:mm:ss'}}</td>
                        <td align="right">Customer:{{sale._customer.name}}</td>
                    </tr>
-->


                            <tr>
                                <td>លក់ជូន/Sold to: {{sale._customer.name }}</td>
                                <td>No: {{sale._id}}</td>
                            </tr>
                            <tr>
                                <td>តំណាងលក់/Seller: {{sale._rep.name}}</td>
                                <td>កាលបរិច្ឆេទ/Date: {{moFormat sale.saleDate 'DD/MM/YYYY HH:mm:ss'}}</td>
                            </tr>
                            <tr>
                                <td>ទូរស័ព្ទ/Tel: {{sale._customer.telephone}}</td>
                                <td>ប្រភេទវិក្កយបត្រ: {{sale.typeOfInvoice}}</td>
                            </tr>
                            <tr>
                                <td>លេខឡាន/Truck Num: {{sale.truckDoc.number}}</td>
                                <td>ថ្ងៃផុតកំណត់/Due Date: {{moFormat sale.dueDate 'DD/MM/YYYY HH:mm:ss'}}</td>
                            </tr>
                            <tr>
                                <td colspan="2">អាស័យដ្ឋាន/Address: {{sale._customer.address}}</td>
                            </tr>
                            <tr>
                                <td colspan="2">ទៅអាស័យដ្ឋាន/To Address: {{{sale.shipTo}}}</td>
                            </tr>
                        </table>
                        <table border="1" width="100%"
                               style="font-size: 12px; border-collapse:collapse; font-family: 'Khmer OS Battambang';">
                            <tr style="-webkit-print-color-adjust: exact; background-color: lightgrey !important; text-align: center; height: 25px;">
                                <td align="center"> ល.រ​</td>
                                <td align="left"> រាយមុខទំនិញ</td>
                                <td align="right"> បរិមាណ</td>
                                {{#if invoiceTypeSaleOrder sale.invoiceType}}
                                    <td align="right"> បរិមាណនៅសល់</td>
                                {{/if}}
                                <td align="right"> តម្លៃរាយ</td>
                                <td align="right"> បញ្ចុះតម្លៃ</td>
                                <td align="right"> សរុប</td>
                            </tr>
                            {{#each item in sale.saleDetails}}
                                <tr>
                                    <td align="center">{{no @index}}</td>
                                    <td align="left">{{item.itemName}}
                                        &nbsp;&nbsp;{{item.originalQty}}{{{item.itemDoc.name}}}{{item.unitConvertDoc.convertAmount}}
                                        ={{item.qty}}</td>
                                    <td align="right">{{numFormat item.qty '0,0.00'}}{{item.itemDoc._unit.name}}</td>
                                    {{#if invoiceTypeSaleOrder sale.invoiceType}}
                                        <td align="right">{{lookupRemainQty sale item.itemId}}</td>
                                    {{/if}}
                                    <td align="right">{{numFormat item.price '0,0.00'}}</td>
                                    <td align="right">{{numFormat item.discount '0,0.00'}}</td>
                                    <td align="right">{{numFormat item.amount '0,0.00'}}</td>
                                </tr>
                            {{/each}}

                            <tr style="text-align: right;">
                                <td colspan="5">Sub Total:</td>
                                <td colspan="2">{{numFormat sale.subTotal '0,0.00'}} </td>
                            </tr>
                            <tr style="text-align: right;">
                                <td colspan="5" align="right">Dis:</td>
                                <td colspan="2" align="right">{{numFormat sale.discount '0,0.00'}}</td>

                            </tr>
                            <tr style="text-align: right;">
                                <td colspan="5">Total:</td>
                                <td colspan="2">{{numFormat sale.total '0,0.00'}}</td>
                            </tr>
                            {{#each sale._exchangeRate.rates}}
                                <tr style="text-align: right;">
                                    <td colspan="5" align="right">{{toCurrencyId}}:</td>
                                    <td colspan="2" align="right">{{totalFormatted}}{{symbol}}</td>
                                </tr>
                            {{/each}}
                            {{#unless invoiceTypeSaleOrder sale.invoiceType}}
                                {{#if hasPayment sale.paymentObj}}
                                    {{#with sale.paymentObj}}
                                        <tr>
                                            <td>Paid {{currencyId}}:</td>
                                            <td colspan="2" style="font-weight: bold">{{numFormat paidAmount
                                                                                                  '0,0.00'}}</td>
                                            <td colspan="2" style="text-align: right">Change {{currencyId}}:</td>
                                            <td colspan="2" style="text-align: right;font-weight: bold">{{numFormat
                                                    balanceAmount '0,0.00'}}</td>
                                        </tr>
                                    {{/with}}
                                {{/if}}
                            {{/unless}}
                        </table>
                    </div>
                </div>
                <div class="col-md-6">
                    ក្រោយពីបានទទួលទំនិញគ្រប់ចំនួន និង គ្រប់លក្ខណៈ
                    គឺផុតការទទួលខុសត្រូវរបស់អ្នកលក់។
                </div>
            </div>

        {{/with}}
        <!--{{autoprint close="true"}}-->
    {{else}}
        {{> loading}}
    {{/if}}
</template>